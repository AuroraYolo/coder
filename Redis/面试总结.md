## Redis数据结构
字符串String,字段Hash,列表List,集合Set,有序集合SortedSet.HyperLogLog,Geo,Pub/Sub

## Redis分布式锁
先拿setnx来争抢锁,抢到之后,再用expire给锁加一个过期时间防止锁忘记了释放.
如果在setnx之后执行expire之前进程意外crash或者要重启维护了,会怎么样?
锁会永远得不到释放.可以用set指令把setnx和expire合成一条命令来用.

## 假设redis有一亿个key,有10w个key是以某个固定的已知的前缀开头的,如何将他们全部找出来?
keys指令可以扫出指定模式的key列表.但是redis是单线程的,如果线上有业务，keys指令会阻塞一段时间之后恢复.
可以用scan指令.scan指令可以无阻塞的提取吃指定模式的key列表,但是会有一定的重复概率.

## 使用Redis作异步队列
一般使用list结构作为队列,rpush生产消息,lpop消费消息.当lpop没有消息的时候,要适当sleep一会.
如果不使用sleep可以用blpop阻塞住直到消息到来.

如果实现生产一次消费多次,使用pub/sub主题订阅者模式,可以实现1:N的消息队列. pub/sub的缺点是在
消费者下线的情况下,生产的消息会丢失.得使用专业的消息队列.


## 如果有大量的key需要设置同一时间过期,需要注意什么?

如果大量的key过期时间设置的集中,在过期的时间到的时候,redis会出现卡顿现象.一般需要在时间上加一个随机值,使得过期时间分散一些.
## Redis 的同步机制了解么？

Redis 可以使用主从同步，从从同步。第一次同步时，主节点做一次 bgsave，并同时将后续修改操作记录到内存 buffer，待完成后将 rdb 文件全量同步到复制节点，复制节点接受完成后将 rdb 镜像加载到内存。加载完成后，再通知主节点将期间修改的操作记录同步到复制节点进行重放就完成了同步过程。

## 是否使用过 Redis 集群，集群的原理是什么？

Redis Sentinal 着眼于高可用，在 master 宕机时会自动将 slave 提升为 master，继续提供服务。
Redis Cluster 着眼于扩展性，在单个 redis 内存不足时，使用 Cluster 进行分片存储。

## Redis数据淘汰策略
allkeys-lru:尝试回收最少使用的键(LRU),使得新添加的数据有空间存放.
volatile-lru: 尝试回收最少使用的键（LRU），但仅限于在过期集合的键,使得新添加的数据有空间存放。

allkeys-random: 回收随机的键使得新添加的数据有空间存放。

volatile-random: 回收随机的键使得新添加的数据有空间存放，但仅限于在过期集合的键。

volatile-ttl: 回收在过期集合的键，并且优先回收存活时间（TTL）较短的键,使得新添加的数据有空间存放。