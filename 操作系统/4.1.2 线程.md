## 线程

```
线程是进程当中的⼀条执⾏流程。
同⼀个进程内多个线程之间可以共享代码段、数据段、打开的⽂件等资源，但每个线程各⾃都有⼀套独⽴
的寄存器和栈，这样可以确保线程的控制流是相对独⽴的。

线程的优缺点？

线程的优点：
⼀个进程中可以同时存在多个线程；
各个线程之间可以并发执⾏；
各个线程之间可以共享地址空间和⽂件等资源；

线程的缺点：
当进程中的⼀个线程崩溃时，会导致其所属进程的所有线程崩溃。

```

## 线程与进程的⽐较

```
线程与进程的⽐较如下：
进程是资源（包括内存、打开的⽂件等）分配的单位，线程是 CPU 调度的单位；
进程拥有⼀个完整的资源平台，⽽线程只独享必不可少的资源，如寄存器和栈；
线程同样具有就绪、阻塞、执⾏三种基本状态，同样具有状态之间的转换关系；
线程能减少并发执⾏的时间和空间开销；
对于，线程相⽐进程能减少开销，体现在：
线程的创建时间⽐进程快，因为进程在创建的过程中，还需要资源管理信息，⽐如内存管理信息、⽂
件管理信息，⽽线程在创建的过程中，不会涉及这些资源管理信息，⽽是共享它们；
线程的终⽌时间⽐进程快，因为线程释放的资源相⽐进程少很多；
同⼀个进程内的线程切换⽐进程切换快，因为线程具有相同的地址空间（虚拟内存共享），这意味着
同⼀个进程的线程都具有同⼀个⻚表，那么在切换的时候不需要切换⻚表。⽽对于进程之间的切换，
切换的时候要把⻚表给切换掉，⽽⻚表的切换过程开销是⽐较⼤的；
由于同⼀进程的各线程间共享内存和⽂件资源，那么在线程之间数据传递的时候，就不需要经过内核
了，这就使得线程之间的数据交互效率更⾼了；
```

## 线程的上下⽂切换

````
在前⾯我们知道了，线程与进程最⼤的区别在于：线程是调度的基本单位，⽽进程则是资源拥有的基本单
位。
所以，所谓操作系统的任务调度，实际上的调度对象是线程，⽽进程只是给线程提供了虚拟内存、全局变
量等资源。
对于线程和进程，我们可以这么理解：
当进程只有⼀个线程时，可以认为进程就等于线程；
当进程拥有多个线程时，这些线程会共享相同的虚拟内存和全局变量等资源，这些资源在上下⽂切换
时是不需要修改的；
另外，线程也有⾃⼰的私有数据，⽐如栈和寄存器等，这些在上下⽂切换时也是需要保存的。

线程上下⽂切换的是什么？
这还得看线程是不是属于同⼀个进程：
当两个线程不是属于同⼀个进程，则切换的过程就跟进程上下⽂切换⼀样；
当两个线程是属于同⼀个进程，因为虚拟内存是共享的，所以在切换时，虚拟内存这些资源就保持不
动，只需要切换线程的私有数据、寄存器等不共享的数据；
所以，线程的上下⽂切换相⽐进程，开销要⼩很多。

````

## 线程的实现

````

⽤户线程（User Thread）：在⽤户空间实现的线程，不是由内核管理的线程，是由⽤户态的线程库
来完成线程的管理；
内核线程（Kernel Thread）：在内核中实现的线程，是由内核管理的线程；
轻量级进程（LightWeight Process）：在内核中来⽀持⽤户线程；
````
